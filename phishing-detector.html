<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Advanced Phishing Detector</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, Helvetica, sans-serif;
    }

    body {
      min-height: 100vh;
      background: linear-gradient(135deg, #667eea, #764ba2);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .container {
      background: white;
      padding: 40px 30px;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.25);
      width: 100%;
      max-width: 500px;
    }

    h2 {
      text-align: center;
      margin-bottom: 30px;
      color: #333;
    }

    .mode-selector {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }

    .mode-selector button {
      padding: 10px 20px;
      margin: 0 5px;
      border: 1px solid #ddd;
      background: white;
      cursor: pointer;
      border-radius: 6px;
      transition: background 0.3s;
    }

    .mode-selector button.active {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      color: #555;
      font-weight: 500;
    }

    input {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 16px;
      transition: border-color 0.3s;
    }

    input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
    }

    textarea {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      font-family: monospace;
      resize: vertical;
      min-height: 200px;
      transition: border-color 0.3s;
    }

    textarea:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
    }

    button {
      width: 100%;
      padding: 14px;
      background: #667eea;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s;
    }

    button:hover {
      background: #5a6fd1;
    }

    .result {
      margin-top: 20px;
      padding: 15px;
      border-radius: 6px;
      text-align: center;
      font-weight: 500;
    }

    .safe {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .phishing {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .suspicious {
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }
  </style>
</head>
<body>

  <div class="container">
    <h2>Advanced Phishing Detector</h2>

    <div class="mode-selector">
      <button id="urlMode" class="active">URL Analysis</button>
      <button id="webpageMode">Paste HTML</button>
      <button id="fullScanMode">Full Webpage Scan</button>
    </div>

    <form id="urlForm">
      <div class="form-group">
        <label for="url">Enter URL to Check</label>
        <input type="url" id="url" placeholder="https://example.com" required>
      </div>

      <button type="submit">Check URL</button>
    </form>

    <form id="webpageForm" style="display: none;">
      <div class="form-group">
        <label for="htmlContent">Paste Webpage HTML Source</label>
        <textarea id="htmlContent" placeholder="Paste the HTML source code of the suspicious webpage here..." required></textarea>
      </div>

      <button type="submit">Analyze Webpage</button>
    </form>

    <form id="fullScanForm" style="display: none;">
      <div class="form-group">
        <label for="scanUrl">Enter URL to Scan Entire Webpage</label>
        <input type="url" id="scanUrl" placeholder="https://suspicious-site.com" required>
      </div>

      <button type="submit">Scan Full Webpage</button>
      <p style="font-size: 12px; color: #666; margin-top: 8px;">Note: This will fetch and analyze the complete webpage content from the provided URL.</p>
    </form>
  </div>

  <script>
    const urlForm = document.getElementById('urlForm');
    const webpageForm = document.getElementById('webpageForm');
    const fullScanForm = document.getElementById('fullScanForm');
    const resultDiv = document.getElementById('result');
    const urlModeBtn = document.getElementById('urlMode');
    const webpageModeBtn = document.getElementById('webpageMode');
    const fullScanModeBtn = document.getElementById('fullScanMode');

    // Mode switching
    urlModeBtn.addEventListener('click', () => {
      urlForm.style.display = 'block';
      webpageForm.style.display = 'none';
      fullScanForm.style.display = 'none';
      urlModeBtn.classList.add('active');
      webpageModeBtn.classList.remove('active');
      fullScanModeBtn.classList.remove('active');
      resultDiv.style.display = 'none';
    });

    webpageModeBtn.addEventListener('click', () => {
      urlForm.style.display = 'none';
      webpageForm.style.display = 'block';
      fullScanForm.style.display = 'none';
      webpageModeBtn.classList.add('active');
      urlModeBtn.classList.remove('active');
      fullScanModeBtn.classList.remove('active');
      resultDiv.style.display = 'none';
    });

    fullScanModeBtn.addEventListener('click', () => {
      urlForm.style.display = 'none';
      webpageForm.style.display = 'none';
      fullScanForm.style.display = 'block';
      fullScanModeBtn.classList.add('active');
      urlModeBtn.classList.remove('active');
      webpageModeBtn.classList.remove('active');
      resultDiv.style.display = 'none';
    });

    function isPhishingURL(url) {
      try {
        const urlObj = new URL(url);

        // Check if HTTPS
        if (urlObj.protocol !== 'https:') {
          return { isPhishing: true, reason: 'URL does not use HTTPS' };
        }

        // Check for IP address instead of domain
        const hostname = urlObj.hostname;
        const ipRegex = /^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;
        if (ipRegex.test(hostname)) {
          return { isPhishing: true, reason: 'URL uses IP address instead of domain name' };
        }

        // Check for suspicious keywords in domain
        const suspiciousKeywords = ['login', 'secure', 'bank', 'paypal', 'amazon', 'account', 'verify', 'update'];
        const domainParts = hostname.split('.');
        const domainName = domainParts.slice(0, -1).join('.').toLowerCase();
        for (let keyword of suspiciousKeywords) {
          if (domainName.includes(keyword)) {
            return { isPhishing: true, reason: `Domain contains suspicious keyword: "${keyword}"` };
          }
        }

        // Check domain length (very short or very long domains might be suspicious)
        if (domainName.length < 4 || domainName.length > 50) {
          return { isSuspicious: true, reason: 'Domain length is unusual' };
        }

        // Check for multiple subdomains
        if (domainParts.length > 3) {
          return { isSuspicious: true, reason: 'URL has multiple subdomains' };
        }

        // Check for URL shortening services (basic check)
        const shorteners = ['bit.ly', 'tinyurl.com', 'goo.gl', 't.co'];
        if (shorteners.includes(hostname)) {
          return { isSuspicious: true, reason: 'URL uses a URL shortening service' };
        }

        return { isSafe: true };

      } catch (e) {
        return { isPhishing: true, reason: 'Invalid URL format' };
      }
    }

    function analyzeWebpageContent(htmlContent) {
      const issues = [];
      const lowerHtml = htmlContent.toLowerCase();

      // Check for login forms
      if (lowerHtml.includes('<form') && (lowerHtml.includes('password') || lowerHtml.includes('login'))) {
        issues.push('Contains login form - potential credential harvesting');
      }

      // Check for hidden inputs (common in phishing)
      const hiddenInputs = (htmlContent.match(/<input[^>]*type="hidden"/gi) || []).length;
      if (hiddenInputs > 2) {
        issues.push('Multiple hidden input fields detected');
      }

      // Check for suspicious scripts
      if (lowerHtml.includes('eval(') || lowerHtml.includes('document.write') || lowerHtml.includes('innerHTML')) {
        issues.push('Contains potentially malicious JavaScript');
      }

      // Check for obfuscated code
      const scriptTags = htmlContent.match(/<script[^>]*>([\s\S]*?)<\/script>/gi) || [];
      for (let script of scriptTags) {
        const scriptContent = script.replace(/<script[^>]*>|<\/script>/gi, '');
        if (scriptContent.length > 1000 && scriptContent.includes('function') === false) {
          issues.push('Large obfuscated script detected');
          break;
        }
      }

      // Check for urgency language
      const urgencyWords = ['urgent', 'immediate', 'action required', 'account suspended', 'verify now', 'limited time'];
      for (let word of urgencyWords) {
        if (lowerHtml.includes(word)) {
          issues.push(`Contains urgency language: "${word}"`);
          break;
        }
      }

      // Check for fake branding
      const brands = ['paypal', 'amazon', 'bank of america', 'chase', 'wells fargo'];
      for (let brand of brands) {
        if (lowerHtml.includes(brand) && !lowerHtml.includes(brand + '.com')) {
          issues.push(`Potential fake branding: "${brand}"`);
          break;
        }
      }

      // Check for external links to suspicious domains
      const links = htmlContent.match(/href="([^"]*)"/gi) || [];
      let suspiciousLinks = 0;
      for (let link of links) {
        const url = link.replace(/href="/, '').replace(/"/, '');
        if (url.startsWith('http') && !url.includes('google') && !url.includes('facebook')) {
          const check = isPhishingURL(url);
          if (check.isPhishing || check.isSuspicious) {
            suspiciousLinks++;
          }
        }
      }
      if (suspiciousLinks > 0) {
        issues.push(`${suspiciousLinks} suspicious external links found`);
      }

      // Check for missing security headers simulation
      if (!lowerHtml.includes('https://') && lowerHtml.includes('http://')) {
        issues.push('Uses insecure HTTP links');
      }

      if (issues.length === 0) {
        return { isSafe: true };
      } else {
        return { isPhishing: true, reasons: issues };
      }
    }

    async function fetchWebpageContent(url) {
      try {
        // Using a CORS proxy to bypass browser restrictions
        const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
        const response = await fetch(proxyUrl + url, {
          method: 'GET',
          headers: {
            'X-Requested-With': 'XMLHttpRequest'
          }
        });

        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const htmlContent = await response.text();
        return htmlContent;
      } catch (error) {
        console.error('Error fetching webpage:', error);
        throw new Error('Unable to fetch webpage content. This may be due to CORS restrictions or the site blocking automated requests.');
      }
    }

    urlForm.addEventListener('submit', function(e) {
      e.preventDefault();

      const url = document.getElementById('url').value.trim();
      const check = isPhishingURL(url);

      resultDiv.style.display = 'block';

      if (check.isSafe) {
        resultDiv.className = 'result safe';
        resultDiv.textContent = '✓ This URL appears to be safe.';
      } else if (check.isPhishing) {
        resultDiv.className = 'result phishing';
        resultDiv.textContent = `⚠️ Potential phishing detected: ${check.reason}`;
      } else if (check.isSuspicious) {
        resultDiv.className = 'result suspicious';
        resultDiv.textContent = `⚠️ Suspicious URL: ${check.reason}. Proceed with caution.`;
      }
    });

    webpageForm.addEventListener('submit', function(e) {
      e.preventDefault();

      const htmlContent = document.getElementById('htmlContent').value.trim();
      const analysis = analyzeWebpageContent(htmlContent);

      resultDiv.style.display = 'block';

      if (analysis.isSafe) {
        resultDiv.className = 'result safe';
        resultDiv.textContent = '✓ This webpage content appears to be safe.';
      } else {
        resultDiv.className = 'result phishing';
        resultDiv.textContent = `⚠️ Potential phishing detected:\n• ${analysis.reasons.join('\n• ')}`;
        resultDiv.style.whiteSpace = 'pre-line';
      }
    });

    fullScanForm.addEventListener('submit', async function(e) {
      e.preventDefault();

      const url = document.getElementById('scanUrl').value.trim();
      const submitBtn = fullScanForm.querySelector('button');
      const originalText = submitBtn.textContent;

      // Show loading state
      submitBtn.textContent = 'Scanning...';
      submitBtn.disabled = true;
      resultDiv.style.display = 'block';
      resultDiv.className = 'result';
      resultDiv.textContent = 'Fetching webpage content...';

      try {
        // First check the URL itself
        const urlCheck = isPhishingURL(url);
        if (urlCheck.isPhishing) {
          resultDiv.className = 'result phishing';
          resultDiv.textContent = `⚠️ URL Analysis: ${urlCheck.reason}\n\nFetching webpage content for deeper analysis...`;
        } else if (urlCheck.isSuspicious) {
          resultDiv.className = 'result suspicious';
          resultDiv.textContent = `⚠️ URL Analysis: ${urlCheck.reason}\n\nFetching webpage content for deeper analysis...`;
        } else {
          resultDiv.textContent = '✓ URL appears safe. Fetching webpage content for deeper analysis...';
        }

        // Fetch and analyze the webpage content
        const htmlContent = await fetchWebpageContent(url);
        const contentAnalysis = analyzeWebpageContent(htmlContent);

        if (contentAnalysis.isSafe && (urlCheck.isSafe || urlCheck.isSuspicious === undefined)) {
          resultDiv.className = 'result safe';
          resultDiv.textContent = '✓ Full webpage scan complete: No phishing indicators detected.';
        } else {
          resultDiv.className = 'result phishing';
          let resultText = '⚠️ Full webpage scan detected potential phishing:\n';

          if (urlCheck.isPhishing || urlCheck.isSuspicious) {
            resultText += `• URL Issue: ${urlCheck.reason}\n`;
          }

          if (!contentAnalysis.isSafe) {
            resultText += `• Content Issues:\n  - ${contentAnalysis.reasons.join('\n  - ')}`;
          }

          resultDiv.textContent = resultText;
          resultDiv.style.whiteSpace = 'pre-line';
        }

      } catch (error) {
        resultDiv.className = 'result phishing';
        resultDiv.textContent = `⚠️ Error scanning webpage: ${error.message}\n\nThis may occur due to:\n• CORS restrictions\n• Site blocking automated requests\n• Network issues\n• Invalid URL\n\nTry using "Paste HTML" mode instead.`;
        resultDiv.style.whiteSpace = 'pre-line';
      } finally {
        // Reset button
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
      }
    });
  </script>

</body>
</html>